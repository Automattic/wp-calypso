/*
 * Navigation bar
 *
 * 1. The Landpack way of injecting custom colors into the nav bar styles
 *    which can also be used on any WPCOM landing page.
 *
 *    All nav bar items default to white, but you can set the specific custom
 *    property to any RGB value like that to use a custom color:
 *
 *    :root {
 *      --lp-color-nav-item: 201, 53, 110;
 *    }
 *
 *    On top of the above, the call to action can optionally have its own color:
 *
 *    :root {
 *      --lp-color-nav-item-primary: 0, 135, 99;
 *    }
 *
 * 2. Increase the specificity due to side effects on older landing pages.
 * 3. Supporting multiple versions, as some of our older landing pages still
 *    contain outdated markup.
 * 4. Using `transform: scale()` to prevent the browser from enforcing any
 *    minimum text size settings.
 * 5. Target only the elements inside the version of the navigation bar that
 *    containers multiple menu items.
 * 6. Increase the specificity due to the double `:not()` selector used above.
 */

.x-hidden {
	border: 0;
	clip: rect(0 0 0 0);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
}

.plugins-listing {
	.masterbar {
		height: 56px;
	}
	.fixed-navigation-header__header {
		top: 56px;
	}
}

%x-list {
	list-style: none;
	margin: 0;
	padding: 0;
	font: inherit;

	li {
		margin: 0;
	}
}

.x-icon--logo {
	left: -1px;
}

.x-icon,
.x-icon span {
	color: inherit;
	display: block;
}
.x-icon {
	fill: currentcolor;
	box-sizing: border-box;
	height: 36px;
	overflow: hidden;
	position: relative;
}

/**
 * Content area
 */

$lp-content-width-center-minus: 480px;
$lp-content-width-center: 576px;
$lp-content-width-center-plus: 672px;
$lp-content-width-wide-minus: 960px;
$lp-content-width-wide: 1056px;

/**
 * Responsive web design
 */

$lp-breakpoint-S: $lp-content-width-center-minus;
$lp-breakpoint-M: 768px;
$lp-breakpoint-L: $lp-content-width-wide;

$x-nav-breakpoint-small: $lp-breakpoint-S;
$x-nav-breakpoint-medium: $lp-breakpoint-M;
$x-nav-breakpoint-medium-wide: 864px;
$x-nav-breakpoint-wide: $lp-breakpoint-L;

$studio-pink-50-rgb: 201, 53, 110;
$studio-white: #fff;
$studio-gray-100: #101517;
$studio-gray-5: #dcdcde;
$studio-blue-60: #055d9c;
$studio-blue-0: #e9f0f5;
$studio-blue-5: #bbe0fa;
$studio-blue-70: #044b7a;
$studio-blue-90: #01283d;
$x-color-link-active: $studio-blue-90;
$x-color-link-background-active: $studio-blue-5;
$x-color-link-hover: $studio-blue-70;
$x-color-link-background-hover: $studio-blue-0;
$x-color-link: $studio-blue-60;
$x-color-content-separator: rgba($studio-gray-5, 0.85);
$studio-white-rgb: 255, 255, 255;
$x-content-min-z-index: 801;
$lp-font-weight-bold: 600;
$lp-chevron-content-right: "\203A";
$lp-chevron-content-down: "\25BE";
$x-nav-breakpoint-small: $lp-breakpoint-S;

$x-nav-padding-top: 9px;
$x-nav-padding-x-narrow: 18px;
$x-nav-padding-x-wide: 24px;

$x-nav-item-padding-x-narrow: 9px;
$x-nav-item-padding-x-wide: 12px;
$x-nav-item-height: 36px;
$x-nav-item-default-color: $studio-white-rgb;
$x-nav-item-font-size: 16px;
$x-nav-item-line-height: $x-nav-item-font-size;

$x-nav-height: $x-nav-padding-top + $x-nav-item-height + $x-nav-item-padding-x-wide;

.x-nav {
	position: absolute;
	z-index: $x-content-min-z-index;
	top: 0;
	right: 0;
	left: 0;
	display: flex;
	justify-content: space-between;
	height: $x-nav-height;
	padding: 0;
	color: unquote("rgb(var(--lp-color-primary, #{$x-nav-item-default-color}))"); /* 1 */
}

.x-nav-list {
	display: flex;
	margin: 0;
}

.x-nav-item {
	display: block;
	color: unquote("rgb( var( --lp-color-nav-item, var( --lp-color-primary, #{$x-nav-item-default-color} ) ) )"); /* 1 */
}

.x-nav-item--wide {
	display: none;
}

.x-nav-link {
	$offset-bottom: round(( $x-nav-item-height - $x-nav-item-line-height ) * 0.5);
	$offset-top: $x-nav-padding-top + ( $x-nav-item-height - $x-nav-item-line-height - $offset-bottom );
	position: relative;
	display: block;
	padding: $offset-top $x-nav-item-padding-x-narrow $offset-bottom;
	color: inherit !important; /* 2 */
	font-size: $x-nav-item-font-size;
	font-weight: $lp-font-weight-bold !important;
	line-height: $x-nav-item-line-height;
	white-space: nowrap;

	&.x-nav-link { /* 2 */
		border: none;
		background: none;
		box-shadow: none;
		overflow: unset;
	}

	&:focus {
		outline: none;
	}

	&::before {
		position: absolute;
		top: $x-nav-padding-top + 1px;
		right: 0;
		bottom: 0;
		left: 0;
		border: 1px solid currentcolor;
		border-radius: var(--lp-control-border-radius, 0.25em);
		opacity: 0.35;
		pointer-events: none;
	}

	&:not(:active):focus::before {
		content: "";
		border: 2px solid Highlight;
		opacity: 1;

		@media ( -webkit-min-device-pixel-ratio: 0 ) {
			border-color: -webkit-focus-ring-color;
		}
	}
}

.x-nav-link--logo {
	padding: $x-nav-padding-top $x-nav-padding-x-wide 0 $x-nav-padding-x-narrow;

	&::before {
		top: $x-nav-padding-top - 1px;
		right: $x-nav-padding-x-wide - $x-nav-item-padding-x-narrow;
		left: $x-nav-padding-x-narrow - $x-nav-item-padding-x-narrow;
	}
}

.x-nav-link--primary {
	padding-right: $x-nav-item-padding-x-narrow + $x-nav-padding-x-narrow;
	padding-left: $x-nav-item-padding-x-narrow * 2;
	color: unquote("rgb( var( --lp-color-nav-item-primary, var(--lp-color-primary, #{$x-nav-item-default-color} ) ) )") !important; /* 1, 2 */

	&:hover,
	&:active {
		text-decoration: underline;
		opacity: 1;
	}

	&:active {
		opacity: 0.85;
	}

	&::before {
		content: "";
		right: $x-nav-padding-x-narrow;
		left: $x-nav-item-padding-x-narrow;
	}
}

.x-nav-link--menu {
	padding: $x-nav-padding-top $x-nav-padding-x-narrow 0 $x-nav-padding-x-wide;

	&::before {
		top: $x-nav-padding-top - 1px;
		right: $x-nav-padding-x-narrow - $x-nav-item-padding-x-narrow;
		left: $x-nav-padding-x-wide - $x-nav-item-padding-x-narrow;
	}
}

.x-nav-link--chevron::after, /* 3 */
.x-nav-link-chevron {
	position: relative;
	left: 1px;
	margin-right: -1px;
	color: inherit;
	opacity: 0.65;
}

.x-nav-link--chevron::after, /* 3 */
.x-nav-link-chevron::before {
	content: $lp-chevron-content-down;
}

.x-nav-link-suffix {
	display: block;
	height: 0;

	/* rtl:ignore */
	text-align: right;
	white-space: nowrap;
	transform: translate(-1px, -10px) scale(0.65); /* 4 */
	transform-origin: 100% 0;
}

/*
 * Dropdown
 */

$x-dropdown-attachment-x: 0;
$x-dropdown-attachment-y: 45px;

$x-dropdown-background-color: $studio-white;
$x-dropdown-background-width: 216px;
$x-dropdown-background-offset-y: 9px;

$x-dropdown-shadow-x: 0;
$x-dropdown-shadow-y: 9px;
$x-dropdown-shadow-blur: 48px;
$x-dropdown-shadow-color: rgba($studio-gray-100, 0.25);

$x-dropdown-item-font-size: 13px;
$x-dropdown-item-line-height: 19px;

.x-dropdown {
	position: absolute;
	z-index: $x-content-min-z-index + 1;
	top: $x-dropdown-attachment-y;
	bottom: 0;

	/* rtl:ignore */
	left: $x-dropdown-attachment-x;
	width: $x-dropdown-background-width + 2 * $x-dropdown-shadow-blur;
	opacity: 0;
	transform-origin: 50% 0;
	pointer-events: none;
}

/*
 * Dropdown background
 *
 * 1. The background element is split into 3 parts: top, middle, bottom. The top
 *    one contains the pointer.
 * 2. The middle part covers the rounding error gap that might appear when
 *    dropdown transforms are in place.
 * 3. The bottom part contains the very background that will be animated using
 *    negative translation. Its height will set programatically.
 */

%x-dropdown-background-container {
	position: absolute;
	right: 0;
	left: 0;
	padding: 0 $x-dropdown-shadow-blur;
	overflow: hidden;
}

.x-dropdown-top { /* 1 */
	@extend %x-dropdown-background-container;
	box-sizing: border-box;
	top: -1 * $x-dropdown-shadow-blur;
	height: 2 * $x-dropdown-shadow-blur;
	padding-top: $x-dropdown-shadow-blur + $x-dropdown-background-offset-y;
	pointer-events: none;
}

.x-dropdown-middle { /* 2 */
	position: absolute;
	z-index: 1;
	top: $x-dropdown-shadow-blur - 1px;
	right: $x-dropdown-shadow-blur;
	left: $x-dropdown-shadow-blur;
	height: 2px;
	background: $x-dropdown-background-color;
}

.x-dropdown-bottom { /* 3 */
	@extend %x-dropdown-background-container;
	top: $x-dropdown-shadow-blur;
	height: 0; /* 3 */
}

%x-dropdown-background-fill {
	position: relative;
	border-radius: 9px;
	background: $x-dropdown-background-color;
	box-shadow: $x-dropdown-shadow-x $x-dropdown-shadow-y $x-dropdown-shadow-blur $x-dropdown-shadow-color;
}

.x-dropdown-top-fill {
	@extend %x-dropdown-background-fill;
	height: 2 * $x-dropdown-shadow-blur;

	&::before { /* 1 */
		content: "";
		position: absolute;
		top: 0;
		left: round(( $x-dropdown-background-width - 36px ) * 0.5);
		border-radius: 3px;
		background: inherit;
		width: 36px;
		height: 36px;
		transform: rotate(45deg);
	}
}

.x-dropdown-bottom-fill {
	@extend %x-dropdown-background-fill;
	top: -1 * $x-dropdown-shadow-blur;
	height: 0; /* 3 */
}

/*
 * Dropdown content
 *
 * 1. The contents elements are stacked on top of each other.
 * 2. Their visibility is determined by the ARIA attribute.
 * 3. Increase the specificity due to side effects on older landing pages.
 * 4. The equivalent of 13px/18px without Dynamic Type on.
 * 5. Due to the way Dynamic Type is defined in CSS, some of the properties
 *    have to be overriden by repetition.
 */

.x-dropdown-content {
	position: absolute; /* 1 */
	top: 0; /* 1 */
	right: $x-dropdown-shadow-blur;
	left: $x-dropdown-shadow-blur;
	padding: (15px + $x-dropdown-background-offset-y) 0 18px;
	opacity: 0;
	pointer-events: none;

	&[aria-hidden="false"] { /* 2 */
		z-index: 1;
		pointer-events: auto;
	}

	ul {
		@extend %x-list;
	}
}

.x-dropdown-content-separator {
	height: 1px;
	background: $x-color-content-separator;
	margin: 9px 0 12px;
}

.x-dropdown-link.x-dropdown-link { /* 3 */
	display: block;
	padding: 6px 12px 6px 24px;
	font-size: $x-dropdown-item-font-size;
	font-weight: $lp-font-weight-bold;
	line-height: $x-dropdown-item-line-height;
	color: $x-color-link;

	&:hover,
	&:active,
	&:focus {
		background: $x-color-link-background-hover;
		color: $x-color-link-hover;
		opacity: 1;
		transition-property: background, color;
	}

	&:active {
		background: $x-color-link-background-active;
		color: $x-color-link-active;
	}

	.js-dynamic-type-on & {
		/* stylelint-disable-next-line max-line-length */
		/* stylelint-disable-next-line font-family-no-missing-generic-family-keyword */
		font: -apple-system-short-footnote; /* 4 */
		font-family: inherit; /* 5 */
		font-weight: $lp-font-weight-bold; /* 5 */
	}
}


/*
 * Mobile menu
 *
 * 1. The line height values are determined based on the `__lp-line-height`
 *    helper function found in Landpack.
 * 2. The transform origin is set approximately to the middle of the menu icon.
 * 3. Increase the specificity due to side effects on older landing pages.
 * 4. The equivalent of 13px/18px without Dynamic Type on.
 * 5. Due to the way Dynamic Type is defined in CSS, some of the properties
 *    have to be overriden by repetition.
 */

$lp-font-stack-emoji: "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
$lp-font-stack-default: -apple-system, "BlinkMacSystemFont", "Segoe UI", "Roboto", "Helvetica", "Arial", sans-serif, $lp-font-stack-emoji;
$x-content-font-stack: $lp-font-stack-default;

%x-text {
	font-family: $x-content-font-stack;
	text-rendering: optimizelegibility;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

$lp-transition-properties: 0.15s ease-out;
$lp-chevron-transform-right: translate3d(0.15em, 0, 0);
$studio-gray-50: #646970;
$studio-gray-30: #8c8f94;
$x-color-content-icon: $studio-gray-30;
$x-color-content-heading: $studio-gray-50;

$x-menu-width-narrow: 408px;
$x-menu-width-wide: 480px;

$x-menu-outer-offset: 12px;
$x-menu-border-radius: 9px;

$x-menu-item-font-size-narrow: 13px;
$x-menu-item-font-size-wide: 14px;
$x-menu-item-line-height-narrow: $x-menu-item-font-size-narrow + 7px; /* 1 */
$x-menu-item-line-height-wide: $x-menu-item-font-size-wide + 7px; /* 1 */

$x-menu-heading-font-size-small: 12px;
$x-menu-heading-font-size-wide: 13px;
$x-menu-heading-line-height-small: $x-menu-heading-font-size-small + 6px; /* 1 */
$x-menu-heading-line-height-wide: $x-menu-heading-font-size-wide + 7px; /* 1 */

.x-menu {
	@extend %x-text;
	position: absolute;
	z-index: $x-content-min-z-index + 2;
	top: 0;
	right: 0;
	bottom: 0;
	left: 0;
	display: none;
	pointer-events: none;
}

.x-menu--active {
	display: block;
}

.x-menu--open {
	pointer-events: auto;
}

.x-menu-overlay {
	position: fixed;
	top: 0;
	right: 0;
	bottom: 0;
	left: 0;
	background: rgba($studio-gray-100, 0.65);
	opacity: 0;

	.x-menu--active & {
		transition: opacity 0.25s ease-out;
	}

	.x-menu--open & {
		opacity: 1;
		transition-timing-function: ease-in-out;
	}
}

.x-menu-content {
	position: absolute;
	top: $x-menu-outer-offset;
	right: $x-menu-outer-offset;
	left: $x-menu-outer-offset;
	border-radius: $x-menu-border-radius;
	background: $studio-white;
	font-size: $x-menu-item-font-size-narrow;
	line-height: $x-menu-item-line-height-narrow;
	transform: scale(0);
	transform-origin: 100% 0;
	transform-origin: calc(100% - 19px) 15px; /* 2 */
	pointer-events: none;

	@media ( min-width: $x-nav-breakpoint-small ) {
		left: auto;
		width: $x-menu-width-narrow;
	}

	@media ( min-width: $x-nav-breakpoint-medium ) {
		width: $x-menu-width-wide;
		font-size: $x-menu-item-font-size-wide;
		line-height: $x-menu-item-line-height-wide;

		.js-dynamic-type-on & {
			width: $x-menu-width-narrow;
		}
	}

	.x-menu--active & {
		transition: transform 0.25s ease-in-out;
	}

	.x-menu--open & {
		transform: scale(1);
		transition-duration: 0.35s;
		transition-timing-function: cubic-bezier(0.1, 0.6, 0.2, 1);
		pointer-events: auto;
	}
}

.x-menu-button {
	box-sizing: border-box;
	position: absolute;
	z-index: 1;
	top: -1 * $x-menu-outer-offset;
	right: -1 * $x-menu-outer-offset;
	width: $x-menu-outer-offset + 36px;
	height: $x-menu-outer-offset + 36px;
	padding-top: $x-menu-outer-offset;
	color: $x-color-content-icon;

	&.x-menu-button { /* 3 */
		border: none;
		background: none;
		box-shadow: none;
	}
}

.x-menu-list {
	padding: 12px;

	&:last-of-type {
		padding-bottom: 18px;
	}

	@media ( min-width: $x-nav-breakpoint-medium ) {
		padding: 18px;

		&:last-of-type {
			padding-bottom: 24px;
		}
	}

	& + & {
		border-top: 1px solid $x-color-content-separator;
	}
}

.x-menu-list-title {
	position: relative;
	top: 1px;
	padding: 6px 6px 3px;
	color: $x-color-content-heading;
	font-size: $x-menu-heading-font-size-small;
	font-weight: 400;
	line-height: $x-menu-heading-line-height-small;
	text-transform: uppercase;

	@media ( min-width: $x-nav-breakpoint-medium ) {
		top: -2px;
		padding-bottom: 0;
		font-size: $x-menu-heading-font-size-wide;
		line-height: $x-menu-heading-line-height-wide;
	}
}

.x-menu-grid {
	@extend %x-list;
	display: grid;
	grid-template-columns: 1fr 1fr;

	:not(.x-menu-list-title) ~ & {
		margin-top: -3px;
	}

	.js-dynamic-type-on & {
		display: block;
	}
}

.x-menu-link.x-menu-link { /* 3 */
	display: block;
	padding: 6px 6px 3px;
	color: $x-color-link;
	font-size: inherit;
	font-weight: $lp-font-weight-bold;
	line-height: inherit;

	.js-dynamic-type-on & {
		/* stylelint-disable-next-line max-line-length */
		/* stylelint-disable-next-line font-family-no-missing-generic-family-keyword */
		font: -apple-system-short-footnote; /* 4 */
		font-family: inherit; /* 5 */
		font-weight: $lp-font-weight-bold; /* 5 */
	}
}

.x-menu-link-chevron {
	display: inline-block;
	color: inherit;
	font-weight: 400;
	transition: transform $lp-transition-properties;

	&::before {
		content: $lp-chevron-content-right;
	}

	.x-menu-link:hover &,
	.x-menu-link:active & {
		transform: $lp-chevron-transform-right;
	}
}

@media ( min-width: $x-nav-breakpoint-small ) {
	.x-nav-link--logo {
		padding-left: $x-nav-padding-x-wide;

		&::before {
			left: $x-nav-padding-x-wide - $x-nav-item-padding-x-narrow;
		}
	}

	.x-nav-link--menu {
		padding-right: $x-nav-padding-x-wide;

		&::before {
			right: $x-nav-padding-x-wide - $x-nav-item-padding-x-narrow;
		}
	}
}

@media ( min-width: $x-nav-breakpoint-medium-wide ) {
	.x-nav-item--narrow {
		display: none;
	}

	.x-nav-item--wide {
		display: block;
	}

	.x-nav-item:not(:only-child) .x-nav-link--logo { /* 5 */
		padding-right: $x-nav-item-padding-x-wide;

		&::before {
			right: $x-nav-item-padding-x-wide - $x-nav-item-padding-x-narrow;
		}
	}
}

@media ( min-width: $x-nav-breakpoint-wide ) {
	.x-nav-link:not(.x-nav-link--logo):not(.x-nav-link--menu) {
		padding-right: $x-nav-item-padding-x-wide;
		padding-left: $x-nav-item-padding-x-wide;
	}

	.x-nav-link--logo {
		padding-left: $x-nav-padding-x-wide;

		&::before {
			left: $x-nav-padding-x-wide - $x-nav-item-padding-x-wide;
		}

		.x-nav-item:not(:only-child) & { /* 5 */
			padding-right: $x-nav-item-padding-x-wide * 1.5;

			&::before {
				left: $x-nav-padding-x-wide - $x-nav-item-padding-x-wide;
			}
		}
	}

	.x-nav-link.x-nav-link.x-nav-link--primary { /* 6 */
		padding-right: $x-nav-item-padding-x-wide + $x-nav-padding-x-wide;
		padding-left: $x-nav-item-padding-x-wide * 2;

		&::before {
			right: $x-nav-padding-x-wide;
			left: $x-nav-item-padding-x-wide;
		}
	}
}
