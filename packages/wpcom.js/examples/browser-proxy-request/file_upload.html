<!DOCTYPE html>
<html>
  <head>
    <title>wpcom.js file upload browser example</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>
  <body>
    <div>
      <input type="file" id="file" multiple />
    </div>
    <script src="/wpcom-proxy.js"></script>
    <script>
      var wpcom = WPCOM();

      wpcom.request({
        metaAPI: { accessAllUsersBlogs: true }
      }, function(err) {
        if (err) throw err;
        console.log('proxy now running in "access all user\'s blogs" mode');
      });

      // select files on the "input" element
      var input = document.getElementById('file');

      input.onchange = function (e) {
        var files = [];
        for (var i = 0; i < e.target.files.length; i++) {
          files.push(e.target.files[i]);
        }

        wpcom
        .site('publicsiteapitesting.wordpress.com')
        .addMediaFiles(files, function(err, data){
          console.log(data.media.length + ' files uploaded');
        });
      };
    </script>
  </body>
</html>
