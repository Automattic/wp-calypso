#!/usr/bin/env node

/*
 This codemod updates
 ---
 export default React.createClass( {
    displayName: 'SomeDisplayName',
 } );
 ---

 to

 ---
 const SomeDisplayName = React.createClass({
   displayName: 'SomeDisplayName',
 });

 export default SomeDisplayName;
 ---

 To use:
 ./bin/codemods/assign-then-export-react-class path-to-transform/

 */

/**
 * External dependencies
 */
const path = require( 'path' );
const child_process = require( 'child_process' );

/**
 * Internal dependencies
 */
const config = require( './src/config' );
const helpers = require( './src/helpers' );

const args = process.argv.slice( 2 );
if ( args.length === 0 ) {
	process.stdout.write( 'No files to transform\n' );
	process.exit( 0 );
}

const binArgs = [
	// jscodeshift options
	'--transform=bin/codemods/src/assign-then-export-react-class.js',
	...config.jscodeshiftArgs,

	// Recast options via 5to6
	...config.recastArgs,

	// Transform target
	...args,
];
const binPath = path.join( '.', 'node_modules', '.bin', 'jscodeshift' );
const jscodeshift = child_process.spawn( binPath, binArgs );
helpers.bindEvents( jscodeshift );
